<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, viewport-fit=cover">
    <title>Минибары</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <link rel="shortcut icon" type="image/x-icon" href="favicon.ico">
    <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
    <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="48x48" href="favicon.ico">
    <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="192x192" href="android-chrome-192x192.png">
    <link rel="icon" type="image/png" sizes="512x512" href="android-chrome-512x512.png">
    <link rel="manifest" href="site.webmanifest">
    
    <!-- Microsoft -->
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="theme-color" content="#ffffff">
    
    <!-- External styles -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet"/>
    
    <!-- App styles -->
    <link rel="stylesheet" href="css/styles.css">
    
    <!-- PDF.js для парсера депатчеров -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.4.120/pdf.min.js"></script>
    
    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
</head>
<body>
    <div class="app">
        <!-- LEFT NAV (desktop) -->
        <nav aria-hidden="false" class="nav">
            <div class="logo"><i class="fas fa-wine-bottle" style="padding-right:10px;"></i>Минибары</div>
            <div class="nav-item active" data-tab="accises"><i class="fas fa-file-invoice"></i><span>Акцизы</span></div>
            <div class="nav-item" data-tab="dispatchers"><i class="fas fa-file-pdf"></i><span>Депатчеры</span></div>
            <div class="nav-item" data-tab="sroki"><i class="fas fa-door-closed"></i><span>Сроки</span></div>
            <div class="nav-item" data-tab="history"><i class="fas fa-history"></i><span>История</span></div>
            <div class="nav-item" data-tab="gih"><i class="fas fa-users"></i><span>GIH</span></div>
            <div class="nav-separator"></div>
            <div class="nav-item extra" data-tab="emptied"><i class="fas fa-box-open"></i><span>Пустые</span></div>
            <div class="nav-item extra" data-tab="calculator"><i class="fas fa-calculator"></i><span>Калькулятор</span></div>
            <div class="nav-item extra" data-tab="learning"><i class="fas fa-book-open"></i><span>Обучение</span></div>
            <div class="nav-item extra" data-tab="settings"><i class="fas fa-cog"></i><span>Настройки</span></div>
            <div class="nav-separator"></div>
            <!-- Desktop connection status -->
            <div class="connection-status disconnected" id="connectionStatus">
                <span class="dot"></span>
                <span class="text">Соединение...</span>
            </div>
            <div id="accise-input-container" style="margin-top:12px; display:flex; gap:10px; align-items:center;">
                <input class="input" id="new-accise" placeholder="Введите акциз ..."/>
            </div>
        </nav>
        
        <main class="content" id="main-content">
            <!-- Mobile top header (burger + sync) -->
            <div class="mb-header" id="mbHeader">
                <button aria-label="Открыть меню" class="mb-burger-btn" id="mbBurgerBtn">☰</button>
                <input class="input" id="new-accise-mobile" placeholder="Введите акциз ..." style="max-width:160px; margin-left:10px;"/>
                <div class="right" id="mbHeaderRight">
                    <div class="mobile-connection-indicator disconnected" id="mobileConnectionIndicator"></div>
                </div>
                <div class="mb-burger-menu" id="mbBurgerMenu" role="menu">
                    <div class="mb-burger-item" data-tab="emptied"><i class="fas fa-box-open"></i><span>Пустые</span></div>
                    <div class="mb-burger-item" data-tab="calculator"><i class="fas fa-calculator"></i><span>Калькулятор</span></div>
                    <div class="mb-burger-item" data-tab="learning"><i class="fas fa-book-open"></i><span>Обучение</span></div>
                    <div class="mb-burger-item" data-tab="settings"><i class="fas fa-cog"></i><span>Настройки</span></div>
                </div>
            </div>
            
            <!-- Page content will be loaded here -->
            <div id="page-content"></div>
        </main>
        
        <!-- MOBILE: bottom navigation -->
        <div aria-hidden="true" class="bottom-nav" id="bottomNav">
            <div class="mobile-connection-indicator disconnected" id="mobileConnectionIndicatorBottom"></div>
            <div class="b-item active" data-tab="accises" title="Акцизы">
                <i class="fas fa-file-invoice"></i>
                <div class="b-label">Акцизы</div>
            </div>
            <div class="b-item" data-tab="dispatchers" title="Депатчеры">
                <i class="fas fa-list"></i>
                <div class="b-label">Депатчеры</div>
            </div>
            <div class="b-item" data-tab="sroki" title="Сроки">
                <i class="fas fa-door-closed"></i>
                <div class="b-label">Сроки</div>
            </div>
            <div class="b-item" data-tab="history" title="История">
                <i class="fas fa-history"></i>
                <div class="b-label">История</div>
            </div>
            <div class="b-item" data-tab="gih" title="GIH">
                <i class="fas fa-users"></i>
                <div class="b-label">GIH</div>
            </div>
        </div>
    </div>
    
    <!-- Modal (rooms) -->
    <div aria-hidden="true" class="overlay" id="modal">
        <div aria-modal="true" class="modal" role="dialog">
            <div class="modal-head">
                <div>
                    <div class="modal-title" style="font-weight:700">Номер <span id="modal-room">—</span></div>
                    <div class="muted">Выберите продукты</div>
                </div>
                <div>
                    <button aria-label="Закрыть" class="btn ghost small" id="modal-close"><i class="fas fa-times"></i></button>
                </div>
            </div>
            <div class="products-wrap" id="modal-products"></div>
            <div class="modal-foot" style="display:flex; gap:8px; margin-top:12px; justify-content:flex-end;">
                <button class="btn ghost small" id="modal-reset">Сброс</button>
                <button class="btn secondary small" id="modal-ok-order">Сроки в порядке</button>
                <button class="btn small" id="modal-save"><i class="fas fa-check"></i> Завершить</button>
            </div>
        </div>
    </div>
    
    <!-- Deadlines stats modal -->
    <div aria-hidden="true" class="overlay" id="deadlines-stats-modal">
        <div aria-modal="true" class="modal" role="dialog">
            <div class="modal-head">
                <div>
                    <div class="modal-title" style="font-weight:700">Статистика сроков</div>
                    <div class="muted" style="font-size:12px;">Текущие статусы номеров и продуктов</div>
                </div>
                <div>
                    <button aria-label="Закрыть" class="btn ghost small" id="deadlines-stats-close"><i class="fas fa-times"></i></button>
                </div>
            </div>
            <div id="deadlines-stats-content" style="display:flex; flex-direction:column; gap:16px;">
                <div style="display:flex; gap:12px; flex-wrap:wrap;">
                    <div class="card" style="flex:1; min-width:160px; padding:12px;">
                        <div class="muted" style="font-size:12px;">Номеров в порядке</div>
                        <div style="font-size:24px; font-weight:700;color:#1b7a2b" id="deadlines-count-ok">0</div>
                    </div>
                    <div class="card" style="flex:1; min-width:160px; padding:12px;">
                        <div class="muted" style="font-size:12px;">Номеров заменить</div>
                        <div style="font-size:24px; font-weight:700; color:#c12a35;" id="deadlines-count-products">0</div>
                    </div>
                    <div class="card" style="flex:1; min-width:160px; padding:12px;">
                        <div class="muted" style="font-size:12px;">Осталось проверить</div>
                        <div style="font-size:24px; font-weight:700;" id="deadlines-count-neutral">0</div>
                    </div>
                </div>
                <div class="card" style="padding:12px;">
                    <div style="font-weight:600; margin-bottom:8px;">Статистика по продуктам</div>
                    <div class="muted" style="font-size:12px; margin-bottom:8px;">Суммарное количество продуктов с истекающим сроком</div>
                    <div id="deadlines-products-stats" style="display:flex; flex-wrap:wrap; gap:8px; font-size:13px;"></div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Scripts -->
    <script src="js/common.js"></script>
    <script src="router.js"></script>
</body>
</html>
